#include "spectrum2.h"
#include <math.h>


//520

float calculate_a_2(float I, float T) { 
    return 6.23833f
         + 1.993e-03f * I
         + 0.02745f   * T
         + 5.786e-07f * I * I
         + 3.315e-05f * T * T
         + 6.506e-06f * I * T;
}

float calculate_b_2(float I, float T) { 
    return 16.09402f
         + 1.215e-03f * I
         + 0.00692f   * T
         - 1.455e-08f * I * I
         - 2.509e-05f * T * T
         - 4.961e-06f * I * T;
}

float calculate_A2_2(float I, float T) {
    return 2.51253f
         - 6.811e-04f * I
         - 0.00312f   * T
         - 3.252e-08f * I * I
         - 6.222e-05f * T * T
         + 2.028e-06f * I * T;
}

float calculate_c_2(float I, float T) {
    return 33.94334f
         + 3.642e-01f * I
         - 0.24604f   * T
         - 1.713e-04f * I * I
         + 9.074e-05f * T * T
         - 1.140e-03f * I * T;
}

float calculate_x1_2(float I, float T) {
    return 522.01285f
         - 1.490e-02f * I
         + 0.07880f   * T
         + 1.119e-05f * I * I
         - 1.957e-04f * T * T
         + 1.015e-05f * I * T;
}


void update_spectrum_array_2(float I, float T, const uint16_t *X_array2, float *Y_array2, uint16_t size) {
    float a = calculate_a_2(I, T);
    float b = calculate_b_2(I, T);
   // float A1 = calculate_A1_2(I, T);
    float A2 = calculate_A2_2(I, T);
    float x1 = calculate_x1_2(I, T);
		float c  = calculate_c_2(I, T);

    for (uint16_t i = 0; i < size; i++) {
        float X = (float)X_array2[i];
        float part1 =  expf((x1 - X) / a);
        float part2 = A2 * expf((X - x1) / b);
        Y_array2[i] = c / (part1 + part2);
    }
}

float Y_array2[NUM_POINTS];
float Z_array2[NUM_POINTS];
float Y_integral2 = 0.0f;
float Z_integral2 = 0.0f;

const uint16_t X_array2[NUM_POINTS] = {300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 
	313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 
	332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 
	352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 
	372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 
	392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 
	412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 
	432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 
	452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 
	472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 
	492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 
	512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 
	532, 533, 534, 535, 536, 537, 538, 539, 540, 541, 542, 543, 544, 545, 546, 547, 548, 549, 550, 551, 
	552, 553, 554, 555, 556, 557, 558, 559, 560, 561, 562, 563, 564, 565, 566, 567, 568, 569, 570, 571, 
	572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583, 584, 585, 586, 587, 588, 589, 590, 591, 
	592, 593, 594, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 605, 606, 607, 608, 609, 610, 611, 
	612, 613, 614, 615, 616, 617, 618, 619, 620, 621, 622, 623, 624, 625, 626, 627, 628, 629, 630, 631, 
	632, 633, 634, 635, 636, 637, 638, 639, 640, 641, 642, 643, 644, 645, 646, 647, 648, 649, 650, 651, 
	652, 653, 654, 655, 656, 657, 658, 659, 660, 661, 662, 663, 664, 665, 666, 667, 668, 669, 670, 671, 672, 
	673, 674, 675, 676, 677, 678, 679, 680, 681, 682, 683, 684, 685, 686, 687, 688, 689, 690, 691, 692, 693, 
	694, 695, 696, 697, 698, 699, 700, 701, 702, 703, 704, 705, 706, 707, 708, 709, 710, 711, 712, 713, 714, 
	715, 716, 717, 718, 719, 720, 721, 722, 723, 724, 725, 726, 727, 728, 729, 730, 731, 732, 733, 734, 735, 
736, 737, 738, 739, 740, 741, 742, 743, 744, 745, 746, 747, 748, 749, 750};//波长300-750


const float Excitation2[NUM_POINTS] = {
		0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
    0.665000, 0.618000, 0.624000, 0.652000, 0.673000, 0.677000, 0.678000, 0.658000, 0.691000, 0.726000, 
    0.762000, 0.795000, 0.787000, 0.841000, 0.893000, 0.871000, 0.907000, 0.947000, 0.987000, 1.031000, 
    1.074000, 1.111000, 1.132000, 1.208000, 1.277000, 1.353000, 1.410000, 1.423000, 1.501000, 1.550000, 
    1.647000, 1.716000, 1.795000, 1.921000, 2.018000, 2.098000, 2.214000, 2.332000, 2.483000, 2.685000, 
    2.916000, 3.151000, 3.324000, 3.550000, 3.889000, 4.287000, 4.623000, 4.961000, 5.224000, 5.517000, 
    5.768000, 6.124000, 6.425000, 6.839000, 7.181000, 7.540000, 7.975000, 8.391000, 8.934000, 9.560000, 
    10.032000, 10.697000, 11.413000, 12.043000, 12.758000, 13.585000, 14.265000, 15.289000, 16.261000, 17.293000, 
    18.808000, 20.300000, 21.666000, 22.980000, 24.571000, 26.165000, 27.918000, 29.477000, 31.222000, 32.573000, 
    34.011000, 35.276000, 36.474000, 37.471000, 38.356000, 39.175000, 39.931000, 40.584000, 41.251000, 41.746000, 
    42.295000, 43.133000, 44.063000, 45.011000, 46.473000, 47.950000, 49.264000, 51.159000, 53.216000, 55.652000, 
    57.949000, 60.862000, 64.075000, 67.272000, 70.754000, 74.605000, 78.882000, 82.395000, 86.766000, 90.505000, 
    93.863000, 96.861000, 98.602000, 100.000000, 99.849000, 99.446000, 96.753000, 93.407000, 88.926000, 83.209000, 
    77.159000, 70.784000, 64.278000, 57.615000, 50.653000, 44.223000, 38.099000, 32.641000, 27.825000, 23.527000, 
    19.609000, 16.536000, 13.772000, 11.451000, 9.592000, 8.063000, 6.746000, 5.721000, 4.981000, 4.516000, 
    4.551000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
    0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 0.000000, 
    0.000000
		
		
		
		
		

};
/*
const float Excitation2[NUM_POINTS] ={
//22.38770871   ,
//21.43920985   ,
//20.52206632   ,
//19.59708395   ,
//18.78184526   ,
//18.08418907   ,
//17.46492122   ,
//16.9945912    ,
//16.59481069   ,
//16.23422435   ,
//15.88931567   ,
//15.59927883   ,
//15.40330799   ,
//15.09759348   ,
//14.8702673    ,
//14.71349063   ,
//14.50968096   ,
//14.21180528   ,
//13.83554127   ,
//13.59253743   ,
//13.23978992   ,
//12.97326958   ,
//12.6048444    ,
//12.33832406   ,
//12.03260955   ,
//11.70337854   ,
//11.4838912    ,
//11.20953202   ,
//10.92733401   ,
//10.4805205    ,
//10.37861566   ,
//10.16696716   ,
//10.11993415   ,
//9.89260798    ,
//9.657442972   ,
//9.579054637   ,
//9.492827467   ,
//9.500666301   ,
//9.398761464   ,
//9.187112958   ,
//9.194951791   ,
//9.093046955   ,
//9.116563455   ,
//9.053852787   ,
//8.959786784   ,
//9.093046955   ,
//9.022497452   ,
//9.06169162    ,
//9.116563455   ,
//9.17143529    ,
//9.17143529    ,
//9.304695461   ,
//9.343889629   ,
//9.594732304   ,
//9.680959473   ,
//9.69663714    ,
//9.89260798    ,
//10.02586815   ,
//10.22967782   ,
//10.32374383   ,
//10.53539233   ,
//10.61378067   ,
//10.80975151   ,
//10.91165635   ,
//11.16249902   ,
//11.34279219   ,
//11.5779572    ,
//11.75825037   ,
//12.04828721   ,
//12.21290272   ,
//12.47158423   ,
//12.63619973   ,
//12.91055891   ,
//13.12220742   ,
//13.34953359   ,
//13.60037626   ,
//13.78850827   ,
//14.03935094   ,
//14.26667712   ,
//14.46264796   ,
//14.76052363   ,
//14.95649447   ,
//15.19165948   ,
//15.25437015   ,
//15.53656816   ,
//15.7090225    ,
//15.91283217   ,
//16.23422435   ,
//16.48506702   ,
//16.57129419   ,
//16.76726503   ,
//17.03378537   ,
//17.19840088   ,
//17.43356589   ,
//17.62953672   ,
//17.8333464    ,
//17.9979619    ,
//18.16257741   ,
//18.35070941   ,
//18.49180842   ,
//18.62506859   ,
//18.75048993   ,
//18.89942777   ,
//18.9542996    ,
//19.07972094   ,
//19.17378694   ,
//19.32272478   ,
//19.40895195   ,
//19.57356745   ,
//19.70682762   ,
//19.85576546   ,
//20.0517363    ,
//20.25554597   ,
//20.46719448   ,
//20.68668182   ,
//20.92184683   ,
//21.18052834   ,
//21.47056518   ,
//21.70573019   ,
//22.0114447    ,
//22.34067571   ,
//22.70126205   ,
//23.0618484    ,
//23.33620757   ,
//23.62624441   ,
//23.97115309   ,
//24.33173944   ,
//24.77855295   ,
//25.22536647   ,
//25.75056832   ,
//26.2130595    ,
//26.74610018   ,
//27.4280787    ,
//28.09437956   ,
//28.81555225   ,
//29.64646861   ,
//30.5557733    ,
//31.39452849   ,
//32.45277103   ,
//33.44830289   ,
//34.57709493   ,
//35.76859763   ,
//36.96010034   ,
//38.30837971   ,
//39.64098142   ,
//41.02845497   ,
//42.50215568   ,
//44.01505056   ,
//45.54362311   ,
//47.15842283   ,
//48.80457788   ,
//50.52912127   ,
//52.18311515   ,
//53.85984166   ,
//55.60868543   ,
//57.32538998   ,
//59.00290037   ,
//60.68041075   ,
//62.39711531   ,
//64.00407619   ,
//65.57968174   ,
//67.05338246   ,
//68.56627734   ,
//69.97726738   ,
//71.30986909   ,
//72.69734264   ,
//73.98291134   ,
//75.17441405   ,
//76.38864937   ,
//77.58093596   ,
//78.76459983   ,
//80.0188132    ,
//81.2103159    ,
//82.45669044   ,
//83.78145332   ,
//85.05134436   ,
//86.4153014    ,
//87.81061378   ,
//89.14321549   ,
//90.53068903   ,
//91.88680724   ,
//93.16453712   ,
//94.48929999   ,
//95.7513522    ,
//96.93501607   ,
//97.9697421    ,
//98.8555303    ,
//99.48263698   ,
//99.87457866   ,
//100           ,
//99.79619033   ,
//99.23963314   ,
//98.29897311   ,
//96.91149957   ,
//95.03801834   ,
//92.78043427   ,
//89.99764835   ,
//86.83075958   ,
//83.30328447   ,
//79.38386768   ,
//75.11170338   ,
//70.75331191   ,
//66.12840009   ,
//61.49564945   ,
//56.78451046   ,
//52.08121032   ,
//47.42494317   ,
//42.89409736   ,
//38.52786705   ,
//34.38896292   ,
//30.4146743    ,
//26.77745551   ,
//23.36756291   ,
//20.25554597   ,
//17.42572705   ,
//14.92513914   ,
//12.69107157   ,
//10.76271851   ,
//9.17143529    ,
//7.760445246   ,
//6.670847378   ,
//5.785059183   ,
//5.05604766    ,
//4.491651642   ,
//4.068354629   ,
//3.69992945    ,
//3.441247942   ,
//3.182566434   ,
//2.994434428   ,
//2.84549659    ,
//2.751430587   ,
//2.641686917   ,
//2.586815082   ,
//2.508426746   ,
//2.453554911   ,
//2.383005409   ,
//2.351650074   ,
//2.335972407   ,
//2.281100572   ,
//2.226228737   ,
//2.21055107    ,
//2.187034569   ,
//2.187034569   ,
//2.116485067   ,
//2.147840401   ,
//2.116485067   ,
//2.108646233   ,
//2.085129733   ,
//2.085129733   ,
//2.1008074     ,
//2.1008074     ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0             ,
//0
9.0788    ,
9.162271  ,
8.475408  ,
8.033853  ,
7.616828  ,
7.089415  ,
6.758249  ,
6.451613  ,
6.083651  ,
5.850607  ,
5.666626  ,
5.433583  ,
5.323194  ,
5.22507   ,
5.176009  ,
5.151478  ,
5.126947  ,
5.126947  ,
5.139213  ,
5.176009  ,
5.212805  ,
5.310928  ,
5.470379  ,
5.838342  ,
6.157243  ,
6.537471  ,
7.187539  ,
7.690421  ,
8.205568  ,
8.855636  ,
9.199068  ,
9.321722  ,
9.162271  ,
8.782043  ,
8.291426  ,
7.494174  ,
6.880903  ,
6.267632  ,
5.49491   ,
4.992027  ,
4.538207  ,
3.91267   ,
3.520177  ,
3.18901   ,
2.796517  ,
2.538943  ,
2.3059    ,
2.03606   ,
1.888875  ,
1.766221  ,
1.594505  ,
1.520913  ,
1.44732   ,
1.349197  ,
1.300135  ,
1.287869  ,
1.287869  ,
1.263339  ,
1.238808  ,
1.251073  ,
1.226542  ,
1.238808  ,
1.275604  ,
1.300135  ,
1.336931  ,
1.385993  ,
1.398258  ,
1.435055  ,
1.520913  ,
1.557709  ,
1.594505  ,
1.680363  ,
1.704894  ,
1.704894  ,
1.766221  ,
1.790752  ,
1.827548  ,
1.864344  ,
1.864344  ,
1.864344  ,
1.864344  ,
1.864344  ,
1.839813  ,
1.815283  ,
1.815283  ,
1.803017  ,
1.778486  ,
1.717159  ,
1.655832  ,
1.619036  ,
1.58224   ,
1.557709  ,
1.484116  ,
1.435055  ,
1.398258  ,
1.373727  ,
1.336931  ,
1.324666  ,
1.336931  ,
1.3124    ,
1.324666  ,
1.3124    ,
1.300135  ,
1.275604  ,
1.275604  ,
1.251073  ,
1.238808  ,
1.238808  ,
1.238808  ,
1.226542  ,
1.226542  ,
1.238808  ,
1.238808  ,
1.251073  ,
1.251073  ,
1.238808  ,
1.263339  ,
1.263339  ,
1.287869  ,
1.3124    ,
1.336931  ,
1.385993  ,
1.459585  ,
1.508647  ,
1.569974  ,
1.655832  ,
1.753956  ,
1.852079  ,
2.011529  ,
2.146449  ,
2.281369  ,
2.489881  ,
2.673862  ,
2.845578  ,
3.103152  ,
3.311665  ,
3.507911  ,
3.802281  ,
4.035325  ,
4.256102  ,
4.562737  ,
4.820312  ,
5.06562   ,
5.384521  ,
5.629829  ,
5.887403  ,
6.279897  ,
6.574267  ,
6.880903  ,
7.285662  ,
7.629094  ,
7.984791  ,
8.499939  ,
8.941494  ,
9.40758   ,
10.10671  ,
10.67092  ,
11.29646  ,
12.24089  ,
12.98908  ,
13.78634  ,
14.93929  ,
15.84693  ,
16.80363  ,
18.18962  ,
19.23219  ,
20.29928  ,
21.78339  ,
22.86275  ,
23.91758  ,
25.30357  ,
26.27254  ,
27.18018  ,
28.32086  ,
29.11812  ,
29.84178  ,
30.74942  ,
31.38722  ,
32.00049  ,
32.83454  ,
33.49687  ,
34.20827  ,
35.32442  ,
36.25659  ,
37.29916  ,
38.90593  ,
40.26739  ,
41.80056  ,
44.15553  ,
46.10573  ,
48.27671  ,
51.53931  ,
54.12732  ,
56.9361   ,
61.06955  ,
64.23402  ,
67.52116  ,
72.15749  ,
75.5918   ,
79.03839  ,
83.69925  ,
86.97412  ,
90.04047  ,
93.79369  ,
96.07507  ,
97.89034  ,
99.48486  ,
100       ,
99.85282  ,
98.62627  ,
96.95818  ,
94.61548  ,
90.39617  ,
86.63069  ,
82.41138  ,
75.99657  ,
71.0168   ,
65.88985  ,
58.71458  ,
53.55084  ,
48.64467  ,
42.31571  ,
38.04734  ,
34.04882  ,
29.03226  ,
25.72059  ,
22.7033   ,
18.99914  ,
16.61965  ,
14.49773  ,
11.94652  ,
10.35202  ,
8.941494  ,
7.273396  ,
6.243101  ,
5.35999   ,
4.317429  ,
3.679627  ,
3.139948  ,
2.514412  ,
2.146449  ,
1.827548  ,
1.484116  ,
1.275604  ,
1.103888  ,
0.895376  ,
0.7727217 ,
0.6745983 ,
0.5642095 ,
0.490617  ,
0.4415553 ,
0.3924935 ,
0.3556973 ,
0.3311664 ,
0.2943702 ,
0.2821048 ,
0.2698393 ,
0.2575739 ,
0.2330431 ,
0.2207776 ,
0.1962468 ,
0.1717159 ,
0.1471851 ,
0.1471851 ,
0.1226542 ,
0.0981    ,
0.0736    ,
0.0491    ,
0.0368    ,
0.0368    ,
0.0368    ,
0.0491    ,
0.0736    ,
0.0859    ,
0.0981    ,
0.1226542 ,
0.1349197 ,
0.1471851 ,
0.1839814 ,
0.1962468 ,
0.1962468 ,
0.2085122 ,
0.2085122 ,
0.2207776 ,
0.2207776 ,
0.2207776 ,
0.2085122 ,
0.2085122 ,
0.2085122 ,
0.1962468 ,
0.1717159 ,
0.1471851 ,
0.1349197 ,
0.1349197 ,
0.1349197 ,
0.0981    ,
0.0736    ,
0.0613    ,
0.0613    ,
0.0613    ,
0.0491    ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0         ,
0

};
*/
const float Excitation2_T[NUM_POINTS] ={
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
0                 ,
2.2359E-07        ,
1.78855E-07       ,
1.38789E-07       ,
1.06092E-07       ,
1.06906E-07       ,
1.53153E-07       ,
1.94684E-07       ,
1.94852E-07       ,
1.52294E-07       ,
1.06438E-07       ,
1.0153E-07        ,
1.57788E-07       ,
2.20549E-07       ,
2.4478E-07        ,
2.23843E-07       ,
1.52398E-07       ,
9.01474E-08       ,
1.02304E-07       ,
1.59668E-07       ,
2.35249E-07       ,
2.69485E-07       ,
2.39117E-07       ,
1.5976E-07        ,
8.07861E-08       ,
7.61453E-08       ,
1.4484E-07        ,
2.18116E-07       ,
2.63126E-07       ,
2.51855E-07       ,
1.83226E-07       ,
9.08219E-08       ,
4.86476E-08       ,
8.78598E-08       ,
1.66453E-07       ,
2.17597E-07       ,
2.36264E-07       ,
2.02505E-07       ,
1.22333E-07       ,
5.09637E-08       ,
4.21002E-08       ,
1.00855E-07       ,
1.78705E-07       ,
2.22806E-07       ,
2.14007E-07       ,
1.69044E-07       ,
9.36729E-08       ,
3.85149E-08       ,
6.25803E-08       ,
1.43229E-07       ,
2.21427E-07       ,
2.71338E-07       ,
2.70541E-07       ,
2.14919E-07       ,
1.23743E-07       ,
5.74712E-08       ,
8.71549E-08       ,
1.8436E-07        ,
3.03859E-07       ,
3.92502E-07       ,
4.32398E-07       ,
4.1118E-07        ,
3.20954E-07       ,
1.78512E-07       ,
1.01793E-07       ,
1.4241E-07        ,
2.68545E-07       ,
4.09441E-07       ,
5.23374E-07       ,
5.90156E-07       ,
6.07497E-07       ,
5.74527E-07       ,
4.58915E-07       ,
2.85845E-07       ,
2.32434E-07       ,
2.86078E-07       ,
3.86972E-07       ,
5.1995E-07        ,
6.33026E-07       ,
7.02315E-07       ,
7.29421E-07       ,
7.14255E-07       ,
6.09275E-07       ,
4.58354E-07       ,
4.59963E-07       ,
4.83953E-07       ,
4.48179E-07       ,
4.89505E-07       ,
6.20816E-07       ,
7.32785E-07       ,
7.88184E-07       ,
7.70232E-07       ,
6.84814E-07       ,
7.34247E-07       ,
8.0638E-07        ,
7.85368E-07       ,
6.61036E-07       ,
5.60614E-07       ,
6.91553E-07       ,
8.33776E-07       ,
9.03192E-07       ,
9.28302E-07       ,
9.38128E-07       ,
9.42454E-07       ,
9.44813E-07       ,
9.45989E-07       ,
9.46945E-07       ,
9.47485E-07       ,
9.47873E-07       ,
9.48095E-07       ,
9.48234E-07       ,
9.48304E-07       ,
9.48404E-07       ,
9.48406E-07       ,
9.48358E-07       ,
1.9312E-06        ,
1.31635E-05       ,
0.000177285       ,
0.00320783        ,
0.135423822       ,
0.745357934       ,
0.961814744       ,
0.974347872       ,
0.976231314       ,
0.944827822       ,
0.943166349       ,
0.969467721       ,
0.967053509       ,
0.948266645       ,
0.934740362       ,
0.906409898       ,
0.860982748       ,
0.80790175        ,
0.730310423       ,
0.634497571       ,
0.537737874       ,
0.45133183        ,
0.362894422       ,
0.254858561       ,
0.104001647       ,
0.003622906       ,
0.000376737       ,
1.40122E-05       ,
9.78318E-07       ,
1.30504E-07       ,
2.72293E-08       ,
1.0469E-08        ,
1.043E-08         ,
1.21847E-08       ,
1.31851E-08       ,
1.35432E-08       ,
1.25789E-08       ,
1.29542E-08       ,
1.16736E-08       ,
1.27965E-08       ,
1.35147E-08       ,
1.35109E-08       ,
1.30482E-08       ,
1.42823E-08       ,
1.52389E-08       ,
1.4802E-08        ,
1.45977E-08       ,
1.37617E-08       ,
1.13991E-08       ,
1.42092E-08       ,
1.387E-08         ,
1.37094E-08       ,
1.37456E-08       ,
1.52389E-08       ,
1.45834E-08       ,
1.47545E-08       ,
1.35251E-08       ,
1.35613E-08       ,
1.42006E-08       ,
1.45246E-08       ,
1.35784E-08       ,
1.44315E-08       ,
1.44856E-08       ,
1.59391E-08       ,
1.8678E-08        ,
1.94969E-08       ,
1.89781E-08       ,
1.79597E-08       ,
1.7593E-08        ,
1.61928E-08       ,
1.66411E-08       ,
1.55477E-08       ,
1.33294E-08       ,
1.33114E-08       ,
1.37874E-08       ,
1.40306E-08       ,
1.41199E-08       ,
1.41199E-08       ,
1.4174E-08        ,
1.47032E-08       ,
1.49245E-08       ,
1.41778E-08       ,
1.65975E-08       ,
1.6929E-08        ,
1.67532E-08       ,
1.59021E-08       ,
1.48855E-08       ,
1.39127E-08       ,
1.33608E-08       ,
1.24403E-08       ,
1.24365E-08       ,
1.27424E-08       ,
1.24032E-08       ,
1.38472E-08       ,
1.6054E-08        ,
1.6834E-08        ,
1.75874E-08       ,
1.90067E-08       ,
1.97771E-08       ,
2.14481E-08       ,
2.10425E-08       ,
2.05181E-08       ,
1.95766E-08       ,
1.7308E-08        ,
1.54936E-08       ,
1.2578E-08        ,
1.07122E-08       ,
9.14852E-09       ,
9.2492E-09        ,
1.22711E-08       ,
1.56807E-08       ,
1.86171E-08       ,
2.00412E-08       ,
2.12591E-08       ,
2.33548E-08       ,
2.46877E-08       ,
2.55502E-08       ,
2.54771E-08       ,
2.49641E-08       ,
2.3579E-08        ,
2.0806E-08        ,
1.98132E-08       ,
1.93325E-08       ,
1.89041E-08       ,
1.91206E-08       ,
1.86675E-08       ,
1.87748E-08       ,
1.86884E-08       ,
2.17854E-08       ,
2.35705E-08       ,
4.30359E-08       ,
5.38139E-08       ,
4.83777E-08       ,
3.49409E-08       ,
3.63256E-08       ,
3.53153E-08       ,
3.53258E-08       ,
3.37564E-08       ,
3.22516E-08       ,
3.00922E-08       ,
2.74084E-08       ,
2.64632E-08       ,
2.28276E-08       ,
1.99215E-08       ,
1.73651E-08       ,
1.72843E-08       ,
1.69461E-08       ,
1.76434E-08       ,
1.92964E-08       ,
2.32132E-08       ,
2.58058E-08       ,
3.13576E-08       ,
3.50607E-08       ,
4.00957E-08       ,
4.67628E-08       ,
5.15005E-08       ,
5.55018E-08       ,
5.78617E-08       ,
5.83623E-08       ,
5.82236E-08       ,
5.64091E-08       ,
5.49499E-08       ,
5.21104E-08       ,
4.77309E-08       ,
4.45217E-08       ,
3.94506E-08       ,
3.61665E-08       ,
3.32386E-08       ,
3.17956E-08       ,
2.96153E-08       ,
3.04019E-08       ,
3.31085E-08       ,
3.62853E-08       ,
4.2693E-08        ,
4.80377E-08       ,
5.34014E-08       ,
5.90473E-08       ,
6.55643E-08       ,
7.22988E-08       ,
7.82391E-08       ,
8.32096E-08       ,
8.64662E-08       ,
8.89181E-08       ,
8.85438E-08       ,
8.64415E-08       ,
8.50563E-08       ,
8.10388E-08       ,
7.32308E-08       ,
6.72059E-08       ,
6.35274E-08       ,
5.88192E-08       ,
5.57888E-08       ,
5.1756E-08        ,
4.94218E-08       ,
4.72596E-08       ,
4.80225E-08       ,
5.16411E-08       ,
5.54429E-08       ,
5.83727E-08       ,
6.48375E-08       ,
7.22085E-08       ,
8.11851E-08       ,
9.1656E-08        ,
9.99809E-08       ,
1.07939E-07       ,
1.15633E-07       ,
1.21834E-07       ,
1.26304E-07       ,
1.28922E-07       ,
1.29911E-07       ,
1.30091E-07       ,
1.30418E-07       ,
1.2871E-07        ,
1.23297E-07       ,
1.16416E-07       ,
1.06466E-07       ,
1.00099E-07       ,
9.5322E-08        ,
9.07564E-08       ,
8.59398E-08       ,
8.33834E-08       ,
8.29711E-08       ,
8.74988E-08       ,
9.30705E-08       ,
9.79289E-08       ,
1.04583E-07       ,
1.15338E-07       ,
1.26469E-07       ,
1.3759E-07        ,
1.50308E-07       ,
1.61926E-07       ,
1.73458E-07       ,
1.83073E-07       ,
1.92585E-07       ,
2.02813E-07       ,
2.09349E-07       ,
2.14266E-07       ,
2.16349E-07       ,
2.14535E-07       ,
2.1177E-07        ,
2.08411E-07       ,
2.02524E-07       ,
1.94292E-07       ,
1.85351E-07       ,
1.74065E-07       ,
1.67254E-07       ,
1.60072E-07       ,
1.5505E-07        ,
1.53749E-07       ,
1.5672E-07        ,
1.65127E-07       ,
1.75074E-07       ,
1.86134E-07       ,
1.99518E-07       ,
2.13638E-07       ,
2.26494E-07       ,
2.3841E-07        


};
float Y_array2[NUM_POINTS];//300-750的光谱强度
float y_result2, z_result2;

void update_and_use_spectrum_2(float intensity, float temperature) {
    update_spectrum_array_2(intensity, temperature, X_array2, Y_array2, NUM_POINTS);
    // Y_array 现在包含了新的光谱数据，可供后续处理

		compute_integrals_2(&y_result2, &z_result2);//打印y光强，z荧光信号强度
}



void compute_integrals_2(float *y_result2, float *z_result2) {
    float Y_integral2 = 0.0f;
    float Z_integral2 = 0.0f;
    
    // 注意：这里需要处理i=0时Y_array[i-1]的边界情况
    for (int i = 1; i < NUM_POINTS; i++) {
        Z_array2[i] = Y_array2[i] * Excitation2[i] * Excitation2_T[i] / 100;
        Y_integral2 += (Y_array2[i] + Y_array2[i-1])  * 0.5f;
        Z_integral2 += (Z_array2[i] + Z_array2[i-1])  * 0.5f;
    }
    
    *y_result2 = Y_integral2;
    *z_result2 = Z_integral2;
}



